(self.webpackChunkfrontend_spb_ru=self.webpackChunkfrontend_spb_ru||[]).push([[296],{859:function(e){var t=new CustomEvent("imageLoaded");e.exports={imageLoadedEvent:t}},906:function(e,t,n){"use strict";var i=n(802),r=n.n(i),a=n(344),o=n.n(a);r().registerLanguage("javascript",o());var s=function(){document.querySelectorAll("pre code").forEach((function(e){r().highlightBlock(e)}))},l=n(319),d=n.n(l),c=n(575),u=n.n(c),h=n(913),m=n.n(h),f=n(859),p=new(function(){function e(){u()(this,e),this.setControls(),this.bindEventsToControls(),this.setGlobalEventListeners()}return m()(e,[{key:"setGlobalEventListeners",value:function(){var e=this;window.addEventListener("click",(function(t){var n=t.target.closest(".photo-image");n&&(e.currentIndex=d()(e.imageWrappers).indexOf(n),e.showModal())})),window.addEventListener(f.imageLoadedEvent.type,(function(t){e.updateImage()}))}},{key:"setControls",value:function(){this.modal=document.querySelector(".modal"),this.imageWrappers=document.querySelectorAll(".photo-image"),this.lastImageIndex=this.imageWrappers.length-1,this.exit=document.createElement("div"),this.exit.classList.add("exit"),this.exit.innerHTML="⌧",this.leftArrow=this.createArrow("leftArrow"),this.rightArrow=this.createArrow("rightArrow")}},{key:"setNewModalImage",value:function(e){"next"===e&&(this.currentIndex+=1,this.currentIndex>this.lastImageIndex&&(this.currentIndex=0)),"prev"===e&&(this.currentIndex-=1,this.currentIndex<0&&(this.currentIndex=this.lastImageIndex)),this.updateImage()}},{key:"updateImage",value:function(){if(this.modalImage){var e=this.imageWrappers[this.currentIndex].querySelector("img").src;this.modalImage.src=e}}},{key:"bindEventsToControls",value:function(){var e=this;this.rightArrow.onclick=function(){e.setNewModalImage("next")},this.leftArrow.onclick=function(){e.setNewModalImage("prev")},this.exit.onclick=function(){e.modal.removeChild(e.modalImage),e.leftArrow.style.visibility="hidden",e.rightArrow.style.visibility="hidden",e.modal.classList.remove("showModal")}}},{key:"createArrow",value:function(e){var t=document.createElement("div");return t.classList.add("arrow",e),t.innerHTML="⌦",t}},{key:"showModal",value:function(){this.modalImage=document.createElement("img"),this.modalImage.classList.add("modalImage"),this.leftArrow.style.visibility="visible",this.rightArrow.style.visibility="visible",this.updateImage(),this.appendElementsToModal(),this.modal.classList.add("showModal")}},{key:"appendElementsToModal",value:function(){this.modal.appendChild(this.exit),this.modal.appendChild(this.leftArrow),this.modal.appendChild(this.modalImage),this.modal.appendChild(this.rightArrow)}},{key:"refresh",value:function(){this.setControls(),this.bindEventsToControls()}}]),e}()),v=(new(function(){function e(){u()(this,e),this.loadedPages=[],this.load=this.load.bind(this)}return m()(e,[{key:"load",value:function(e){var t=this,n=document.querySelectorAll(".lazyloading-wrapper img.not-a-placeholder");if(0!==n.length){var i=[];n.forEach((function(r){var a=new Image;a.onload=function(){i.push(r);var o=r.closest(".lazyloading-wrapper").querySelector("img.placeholder");o&&o.classList.add("fade-out");var s=getComputedStyle(o).getPropertyValue("--transition-time"),l=parseFloat(s);setTimeout((function(){o.src=a.src,window.dispatchEvent(f.imageLoadedEvent)}),l),i.length===n.length&&t.loadedPages.push(e)},a.src=r.src}))}}}]),e}()),n(69)),g=n.n(v),w=function(){document.querySelectorAll(".navlink a").forEach((function(e){var t=e.getAttribute("href");location.pathname.startsWith(t)?e.classList.add("navlink-active"):e.classList.remove("navlink-active")}))},y=n(757),I=n.n(y),k=n(926),E=n.n(k)()(I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.scrollTo(0,0));case 1:case"end":return e.stop()}}),e)}))),L=function(){function e(){u()(this,e),this.timestamps=document.querySelectorAll(".footer .footer__timestamp"),this.currentYear=(new Date).getFullYear(),this.currentYearString="2018 - ".concat(this.currentYear),this.updateYear=this.updateYear.bind(this),this.updateYear()}return m()(e,[{key:"updateYear",value:function(){var e=this;this.timestamps.forEach((function(t){t&&t.innerHTML!==e.currentYearString&&(t.innerHTML=e.currentYearString)}))}}]),e}(),x=function(){return(new L).updateYear};window.addEventListener("DOMContentLoaded",(function(e){return new Promise((function(e){w(),x(),s(),e()}))}),{once:!0}),g().hooks.beforeEnter((function(e){return new Promise((function(e){E().then(e)}))})),g().hooks.enter((function(e){return new Promise((function(e){w(),x(),s(),e()}))})),g().init({transitions:[{name:"default-instant-transition"}],views:[{namespace:"krooshkin",afterEnter:function(){p.refresh()}}]})}},0,[[906,666,14]]]);